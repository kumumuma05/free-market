# COACHTECHフリマ

商品の出品と購入を行うことができるフリーマーケットWebアプリケーションです。

## 機能概要

- アプリ概要
  - このアプリはユーザー同士が商品を出品・購入できるフリマアプリです。
  - ユーザー登録した会員は、商品の購入のほか、商品を出品および商品説明の登録ができます。
  - 購入時はユーザーの住所以外の配送先住所に変更することが可能です。
  - 会員以外のユーザーは商品一覧と商品詳細を閲覧することはできますが、ほかの機能は使えません。


- 主な機能
  - ユーザー登録・ログイン（メール認証付き）
  - プロフィール編集（名前、アイコン画像選択）
  - 商品出品（タイトル、ブランド、商品カテゴリ、価格、商品説明、画像アップロード、商品コンディション）
  - 商品一覧表示・商品詳細表示（いいね数とコメント数の確認も可能）
  - お気に入り登録/解除
  - コメント登録
  - 商品購入（注文・配送先登録・支払いはコンビニ払いとカード支払いを選択可能）
  - 購入履歴・出品履歴の確認
  
## 環境構築

### Dockerビルド
1. リポジトリをクローン  
コマンドライン上
```bash
git clone git@github.com:kumumuma05/check-test.git
cd check-test
```
2. コンテナの起動  
コマンドライン上
```bash
docker-compose up -d --build
```

### Laravel 環境構築
1. PHPコンテナへ入る  
コマンドライン上
```bash
docker-compose exec php bash
```
2. パッケージのインストール  
PHPコンテナ上
```bash
composer install
```
3. 環境ファイル作成  
PHPコンテナ上
```bash
cp .env.example .env
```
4. アプリキー作成  
PHPコンテナ上
```bash
php artisan key:generate
```
5. マイグレーション実行（初期データも同時投入）  
PHPコンテナ上
```bash
php artisan migrate --seed
```

> ※ 使用しているOSによってはファイル権限が原因でエラーが発生する場合があります。
>その際は環境に合わせて権限を調整してください。  

## ログイン情報
- 本アプリではレビュー用にseederで登録されたユーザーが3名分存在しています。  
（開発環境での動作確認用であり、実際の利用時はユーザー自身が登録します）
  - ユーザー1  
   メールアドレス:user1@test.com  
   パスワード:password
   - ユーザー2  
   メールアドレス:user2@test.com  
   パスワード:password
   - ユーザー3  
   メールアドレス:user3@test.com  
   パスワード:password  
- 本アプリではメール認証機能のレビュー用にMailHogを使用しているため、メール認証時は、同サイトへ遷移するよう設定されています。

## テスト実施要領
  本アプリではPHPUnitを用いたFeatureテストを用意しています。テストにはテスト専用のデータベースを使用しています。テスト実施手順は下記のとおりです。  
1. 準備（初回のみ）  
テスト用マイグレーション実行(初期データも同時投入)  
PHPコンテナ上
```bash
php artisan migrate --seed --env=testing
```
> ※ この作業はテスト用データベースを初期構築する初回のみ（テスト実行時はRefreshDatabaseにより毎回リセットされます）
2. テスト実施  
PHPコンテナ上
```bash
php artisan test
```

## 使用技術

- PHP 8.1-fpm  
- Laravel 8.83.29  
- MySQL 8.0.26  
- Nginx 1.21.1  

## ER図

![ER図](./erd.png)

## URL

- トップページ : http://localhost/  
- ユーザー登録 : http://localhost/register/  
- phpMyAdmin : http://localhost:8080/  
